"""Exercise 1.2.9 from Doyle & Snell (2006)"""

import numpy as np


# ordered from top to bottom, then left to right

# not canonical
P = np.array([[1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
              [0, 1, 0, 0, 0, 0, 0, 0, 0, 0],
              [.25, .25, 0, .25, 0, .25, 0, 0, 0, 0],
              [0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
              [0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
              [0, 0, .25, 0, .25, 0, .25, 0, .25, 0],
              [0, 0, 0, .25, 0, .25, 0, .25, 0, .25],
              [0, 0, 0, 0, 0, 0, 0, 1, 0, 0],
              [0, 0, 0, 0, 0, 0, 0, 0, 1, 0],
              [0, 0, 0, 0, 0, 0, 0, 0, 0, 1]], dtype=np.float64)

# canonical
P_canonical = np.array([[.25, .25, 0, .25, 0, .25, 0, 0, 0, 0],
                        [0, 0, .25, 0, .25, 0, .25, 0, .25, 0],
                        [0, 0, 0, .25, 0, .25, 0, .25, 0, .25],
                        [1, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
                        [0, 1, 0, 0, 0, 0, 0, 0, 0, 0],
                        [0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
                        [0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
                        [0, 0, 0, 0, 0, 0, 0, 1, 0, 0],
                        [0, 0, 0, 0, 0, 0, 0, 0, 1, 0],
                        [0, 0, 0, 0, 0, 0, 0, 0, 0, 1]], dtype=np.float64)

# Raise P to the 10th power
Pn = np.pow(P, 10)
print(f"P matrix:\n{Pn}")